# PARSER_DEBUG_TODOS

// TODO (fix)parser

* filtered as OTHER
  * add `function_call_output` or similar filter type
  * `turn_context`
  * `token_count`
  * `agent_reasoning`
  * `agent_message`


## example filters as `Other`

* parse and reconstruct `output`
  * extract filenames by matching `call_id`
        *

```json
{"timestamp":"2025-11-17T01:17:15.890Z","type":"response_item","payload":{"type":"function_call","name":"shell","arguments":"{\"command\":[\"bash\",\"-lc\",\"nl -ba src/server/function/browserLogs.ts | sed -n '1,200p'\"],\"workdir\":\"/home/user/projects/temp/codex-session-view\"}","call_id":"call_bAuIA6ygHHptPi4H4g5K4gHp"}}
{"timestamp":"2025-11-17T01:17:15.891Z","type":"response_item","payload":{"type":"function_call_output","call_id":"call_bAuIA6ygHHptPi4H4g5K4gHp",
```


// TODO (fix)parser

```json
{
  "at": "2025-11-17T01:17:19.537Z",
  "type": "Other",
  "data": {
    "type": "function_call_output",
    "call_id": "call_HcHmx4vaWeHF9uO4DddmLGpd",
    "output": "{\"output\":\"     1\\timport { createServerFn } from '@tanstack/react-start';\\n     2\\timport { z } from 'zod';\\n     3\\t\\n     4\\tconst inputSchema = z.object({\\n     5\\t  filename: z.string().min(1).max(256),\\n     6\\t  content: z.string().min(1),\\n     7\\t});\\n     8\\t\\n     9\\texport const persistSessionFile = createServerFn({ method: 'POST' })\\n    10\\t  .inputValidator((data: unknown) => inputSchema.parse(data))\\n    11\\t  .handler(async ({ data }) => {\\n    12\\t    const [fs, path] = await Promise.all([loadFsModule(), loadPathModule()]);\\n    13\\t    const targetDir = path.resolve(getHomeDirectory(), '.codex/sessions/uploads');\\n    14\\t    await fs.mkdir(targetDir, { recursive: true });\\n    15\\t    const safeName = sanitizeFilename(data.filename, path.basename);\\n    16\\t    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\\n    17\\t    const finalName = `${timestamp}-${safeName}`;\\n    18\\t    const absolutePath = path.resolve(targetDir, finalName);\\n    19\\t    await fs.writeFile(absolutePath, data.content, 'utf8');\\n    20\\t    return { path: absolutePath };\\n    21\\t  });\\n    22\\t\\n    23\\tfunction getHomeDirectory() {\\n    24\\t  return process.env.HOME ?? process.env.USERPROFILE ?? process.cwd();\\n    25\\t}\\n    26\\t\\n    27\\tfunction sanitizeFilename(value: string, basename: (path: string) => string) {\\n    28\\t  const name = basename(value).replace(/[^a-z0-9._-]/gi, '-');\\n    29\\t  if (!/\\\\.(jsonl|ndjson|json)$/i.test(name)) {\\n    30\\t    return `${name}.jsonl`;\\n    31\\t  }\\n    32\\t  return name;\\n    33\\t}\\n    34\\t\\n    35\\ttype FsModule = typeof import('node:fs/promises');\\n    36\\ttype PathModule = typeof import('node:path');\\n    37\\t\\n    38\\tlet cachedFsModule: FsModule | null = null;\\n    39\\tasync function loadFsModule(): Promise<FsModule> {\\n    40\\t  if (!cachedFsModule) {\\n    41\\t    cachedFsModule = await import('node:fs/promises');\\n    42\\t  }\\n    43\\t  return cachedFsModule;\\n    44\\t}\\n    45\\t\\n    46\\tlet cachedPathModule: PathModule | null = null;\\n    47\\tasync function loadPathModule(): Promise<PathModule> {\\n    48\\t  if (!cachedPathModule) {\\n    49\\t    cachedPathModule = await import('node:path');\\n    50\\t  }\\n    51\\t  return cachedPathModule;\\n    52\\t}\\n\",\"metadata\":{\"exit_code\":0,\"duration_seconds\":0.0}}",
    "at": "2025-11-17T01:17:19.537Z"
  }
}
```

* filtered as args
  * `command`
      * add specific command names instead e.g., `bash`


## session_metrics

// TODO (fix)parser

* filtered as `other`
  * type `token_count`

```json
{
  "at": "2025-11-17T01:17:05.146Z",
  "type": "Other",
  "data": {
    "type": "token_count",
    "info": {
      "total_token_usage": {
        "input_tokens": 1083891,
        "cached_input_tokens": 937216,
        "output_tokens": 20875,
        "reasoning_output_tokens": 17024,
        "total_tokens": 1104766
      },
      "last_token_usage": {
        "input_tokens": 48310,
        "cached_input_tokens": 48128,
        "output_tokens": 42,
        "reasoning_output_tokens": 0,
        "total_tokens": 48352
      },
      "model_context_window": 258400
    },
    "rate_limits": {
      "primary": {
        "used_percent": 7,
        "window_minutes": 300,
        "resets_at": 1763359793
      },
      "secondary": {
        "used_percent": 23,
        "window_minutes": 10080,
        "resets_at": 1763910108
      }
    },
    "at": "2025-11-17T01:17:05.146Z"
  }
}
```

## filtered as `other`

// TODO (fix)parser

* type: `agent_reasoning`
