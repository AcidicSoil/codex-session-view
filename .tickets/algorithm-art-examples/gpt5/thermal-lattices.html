<!DOCTYPE html>
<!--
    THIS IS A TEMPLATE THAT SHOULD BE USED EVERY TIME AND MODIFIED.
    WHAT TO KEEP:
    ✓ Overall structure (header, sidebar, main content)
    ✓ Anthropic branding (colors, fonts, layout)
    ✓ Seed navigation section (always include this)
    ✓ Self-contained artifact (everything inline)

    WHAT TO CREATIVELY EDIT:
    ✗ The p5.js algorithm (implement YOUR vision)
    ✗ The parameters (define what YOUR art needs)
    ✗ The UI controls (match YOUR parameters)

    Let your philosophy guide the implementation.
    The world is your oyster - be creative!
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thermal Lattices — Generative Art Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Lora:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* Anthropic Brand Colors */
        :root {
            --anthropic-dark: #141413;
            --anthropic-light: #faf9f5;
            --anthropic-mid-gray: #b0aea5;
            --anthropic-light-gray: #e8e6dc;
            --anthropic-orange: #d97757;
            --anthropic-blue: #6a9bcc;
            --anthropic-green: #788c5d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--anthropic-light) 0%, #f5f3ee 100%);
            min-height: 100vh;
            color: var(--anthropic-dark);
        }

        .container {
            display: flex;
            min-height: 100vh;
            padding: 20px;
            gap: 20px;
        }

        /* Sidebar */
        .sidebar {
            width: 320px;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(20, 20, 19, 0.1);
            overflow-y: auto;
            overflow-x: hidden;
        }

        .sidebar h1 {
            font-family: 'Lora', serif;
            font-size: 24px;
            font-weight: 500;
            color: var(--anthropic-dark);
            margin-bottom: 8px;
        }

        .sidebar .subtitle {
            color: var(--anthropic-mid-gray);
            font-size: 14px;
            margin-bottom: 32px;
            line-height: 1.4;
        }

        /* Control Sections */
        .control-section {
            margin-bottom: 32px;
        }

        .control-section h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--anthropic-dark);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-section h3::before {
            content: '•';
            color: var(--anthropic-orange);
            font-weight: bold;
        }

        /* Seed Controls */
        .seed-input {
            width: 100%;
            background: var(--anthropic-light);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin-bottom: 12px;
            border: 1px solid var(--anthropic-light-gray);
            text-align: center;
        }

        .seed-input:focus {
            outline: none;
            border-color: var(--anthropic-orange);
            box-shadow: 0 0 0 2px rgba(217, 119, 87, 0.1);
            background: white;
        }

        .seed-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 8px;
        }

        .regen-button {
            margin-bottom: 0;
        }

        /* Parameter Controls */
        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--anthropic-dark);
            margin-bottom: 8px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .slider-container input[type="range"] {
            flex: 1;
            height: 4px;
            background: var(--anthropic-light-gray);
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: var(--anthropic-orange);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            background: #c86641;
        }

        .slider-container input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: var(--anthropic-orange);
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .value-display {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: var(--anthropic-mid-gray);
            min-width: 60px;
            text-align: right;
        }

        /* Color Pickers */
        .color-group {
            margin-bottom: 16px;
        }

        .color-group label {
            display: block;
            font-size: 12px;
            color: var(--anthropic-mid-gray);
            margin-bottom: 4px;
        }

        .color-picker-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .color-picker-container input[type="color"] {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: none;
            padding: 0;
        }

        .color-value {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: var(--anthropic-mid-gray);
        }

        /* Buttons */
        .button {
            background: var(--anthropic-orange);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }

        .button:hover {
            background: #c86641;
            transform: translateY(-1px);
        }

        .button:active {
            transform: translateY(0);
        }

        .button.secondary {
            background: var(--anthropic-blue);
        }

        .button.secondary:hover {
            background: #5a8bb8;
        }

        .button.tertiary {
            background: var(--anthropic-green);
        }

        .button.tertiary:hover {
            background: #6b7b52;
        }

        .button-row {
            display: flex;
            gap: 8px;
        }

        .button-row .button {
            flex: 1;
        }

        /* Canvas Area */
        .canvas-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 0;
        }

        #canvas-container {
            width: 100%;
            max-width: 1000px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(20, 20, 19, 0.1);
            background: white;
        }

        #canvas-container canvas {
            display: block;
            width: 100% !important;
            height: auto !important;
        }

        /* Loading State */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: var(--anthropic-mid-gray);
        }

        /* Responsive - Stack on mobile */
        @media (max-width: 600px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
            }

            .canvas-area {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Control Sidebar -->
        <div class="sidebar">
            <!-- Headers (CUSTOMIZE THIS FOR YOUR ART) -->
            <h1>Thermal Lattices</h1>
            <div class="subtitle">Heat fields and crystalline drift traced through algorithmic lattice conduction.</div>

            <!-- Seed Section (ALWAYS KEEP THIS) -->
            <div class="control-section">
                <h3>Seed</h3>
                <input type="number" id="seed-input" class="seed-input" value="12345" onchange="updateSeed()">
                <div class="seed-controls">
                    <button class="button secondary" onclick="previousSeed()">← Prev</button>
                    <button class="button secondary" onclick="nextSeed()">Next →</button>
                </div>
                <button class="button tertiary regen-button" onclick="randomSeedAndUpdate()">↻ Random</button>
            </div>

            <!-- Parameters Section (CUSTOMIZE THIS FOR YOUR ART) -->
            <div class="control-section">
                <h3>Parameters</h3>

                <div class="control-group">
                    <label>Lattice Spacing</label>
                    <div class="slider-container">
                        <input type="range" id="latticeSpacing" min="12" max="40" step="1" value="22" oninput="updateParam('latticeSpacing', this.value)">
                        <span class="value-display" id="latticeSpacing-value">22</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Thermal Noise Scale</label>
                    <div class="slider-container">
                        <input type="range" id="noiseScale" min="0.002" max="0.02" step="0.001" value="0.008" oninput="updateParam('noiseScale', this.value)">
                        <span class="value-display" id="noiseScale-value">0.008</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Warp Strength</label>
                    <div class="slider-container">
                        <input type="range" id="warpStrength" min="0" max="30" step="1" value="14" oninput="updateParam('warpStrength', this.value)">
                        <span class="value-display" id="warpStrength-value">14</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Heat Sources</label>
                    <div class="slider-container">
                        <input type="range" id="sourceCount" min="2" max="8" step="1" value="4" oninput="updateParam('sourceCount', this.value)">
                        <span class="value-display" id="sourceCount-value">4</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Source Strength</label>
                    <div class="slider-container">
                        <input type="range" id="sourceStrength" min="0.4" max="1.6" step="0.1" value="1.0" oninput="updateParam('sourceStrength', this.value)">
                        <span class="value-display" id="sourceStrength-value">1.0</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Carrier Count</label>
                    <div class="slider-container">
                        <input type="range" id="carrierCount" min="200" max="2000" step="100" value="900" oninput="updateParam('carrierCount', this.value)">
                        <span class="value-display" id="carrierCount-value">900</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Carrier Speed</label>
                    <div class="slider-container">
                        <input type="range" id="carrierSpeed" min="0.2" max="2.0" step="0.1" value="0.8" oninput="updateParam('carrierSpeed', this.value)">
                        <span class="value-display" id="carrierSpeed-value">0.8</span>
                    </div>
                </div>
            </div>

            <!-- Colors Section (OPTIONAL - CUSTOMIZE OR REMOVE) -->
            <div class="control-section">
                <h3>Colors</h3>

                <div class="color-group">
                    <label>Cold Lattice</label>
                    <div class="color-picker-container">
                        <input type="color" id="color1" value="#2b4b73" onchange="updateColor('color1', this.value)">
                        <span class="color-value" id="color1-value">#2b4b73</span>
                    </div>
                </div>

                <div class="color-group">
                    <label>Warm Lattice</label>
                    <div class="color-picker-container">
                        <input type="color" id="color2" value="#d97757" onchange="updateColor('color2', this.value)">
                        <span class="color-value" id="color2-value">#d97757</span>
                    </div>
                </div>

                <div class="color-group">
                    <label>Heat Glow</label>
                    <div class="color-picker-container">
                        <input type="color" id="color3" value="#f0e3c2" onchange="updateColor('color3', this.value)">
                        <span class="color-value" id="color3-value">#f0e3c2</span>
                    </div>
                </div>
            </div>

            <!-- Actions Section (ALWAYS KEEP THIS) -->
            <div class="control-section">
                <h3>Actions</h3>
                <div class="button-row">
                    <button class="button" onclick="regenerateSystem()">Regenerate</button>
                    <button class="button secondary" onclick="resetParameters()">Reset</button>
                </div>
                <div style="margin-top: 8px;">
                    <button class="button tertiary" onclick="downloadArtwork()">Download PNG</button>
                </div>
            </div>
        </div>

        <!-- Main Canvas Area -->
        <div class="canvas-area">
            <div id="canvas-container">
                <div class="loading">Initializing generative art...</div>
            </div>
        </div>
    </div>

    <script>
        // ═══════════════════════════════════════════════════════════════════════
        // GENERATIVE ART PARAMETERS - CUSTOMIZE FOR YOUR ALGORITHM
        // ═══════════════════════════════════════════════════════════════════════

        let params = {
            seed: 12345,
            latticeSpacing: 22,
            noiseScale: 0.008,
            warpStrength: 14,
            sourceCount: 4,
            sourceStrength: 1.0,
            carrierCount: 900,
            carrierSpeed: 0.8,
            colorPalette: ['#2b4b73', '#d97757', '#f0e3c2']
        };

        let defaultParams = {...params};

        // ═══════════════════════════════════════════════════════════════════════
        // P5.JS GENERATIVE ART ALGORITHM - REPLACE WITH YOUR VISION
        // ═══════════════════════════════════════════════════════════════════════

        let latticeNodes = [];
        let heatSources = [];
        let carriers = [];
        let latticeLayer;
        let trailLayer;
        let gradientStep = 6;

        function setup() {
            let canvas = createCanvas(1200, 1200);
            canvas.parent('canvas-container');

            latticeLayer = createGraphics(width, height);
            trailLayer = createGraphics(width, height);

            initializeSystem();

            document.querySelector('.loading').style.display = 'none';
        }

        function initializeSystem() {
            randomSeed(params.seed);
            noiseSeed(params.seed);

            latticeNodes = [];
            heatSources = [];
            carriers = [];

            latticeLayer.clear();
            trailLayer.clear();

            generateHeatSources();
            buildLattice();
            renderLattice();
            spawnCarriers();
        }

        function generateHeatSources() {
            let margin = width * 0.1;
            for (let i = 0; i < params.sourceCount; i++) {
                heatSources.push({
                    x: random(margin, width - margin),
                    y: random(margin, height - margin),
                    strength: random(0.6, 1.2) * params.sourceStrength,
                    falloff: random(0.0015, 0.0035)
                });
            }
        }

        function temperatureAt(x, y) {
            let noiseVal = noise(x * params.noiseScale, y * params.noiseScale);
            let anisotropy = 0.4 + 0.6 * sin((x + y) * 0.004);
            let sourceSum = 0;

            for (let i = 0; i < heatSources.length; i++) {
                let source = heatSources[i];
                let d = dist(x, y, source.x, source.y);
                sourceSum += source.strength * exp(-d * source.falloff);
            }

            let temp = (noiseVal * 0.55 + sourceSum * 0.45) * anisotropy;
            return constrain(temp, 0, 1.2);
        }

        function buildLattice() {
            let spacing = params.latticeSpacing;
            let cols = floor(width / spacing) + 1;
            let rows = floor(height / spacing) + 1;

            for (let col = 0; col < cols; col++) {
                for (let row = 0; row < rows; row++) {
                    let x = col * spacing;
                    let y = row * spacing;
                    let warp = params.warpStrength;
                    let warpX = map(noise(x * 0.01, y * 0.01), 0, 1, -warp, warp);
                    let warpY = map(noise(x * 0.01 + 11.7, y * 0.01 + 9.4), 0, 1, -warp, warp);

                    let px = x + warpX;
                    let py = y + warpY;
                    let temp = temperatureAt(px, py);

                    latticeNodes.push({
                        col,
                        row,
                        x: px,
                        y: py,
                        temp
                    });
                }
            }
        }

        function renderLattice() {
            latticeLayer.background(250, 249, 245);
            latticeLayer.strokeCap(ROUND);

            let spacing = params.latticeSpacing;
            let cols = floor(width / spacing) + 1;
            let rows = floor(height / spacing) + 1;

            let cold = color(params.colorPalette[0]);
            let warm = color(params.colorPalette[1]);
            let glow = color(params.colorPalette[2]);

            function nodeAt(c, r) {
                if (c < 0 || r < 0 || c >= cols || r >= rows) return null;
                return latticeNodes[r + c * rows];
            }

            for (let col = 0; col < cols; col++) {
                for (let row = 0; row < rows; row++) {
                    let node = nodeAt(col, row);
                    if (!node) continue;

                    let neighbors = [
                        nodeAt(col + 1, row),
                        nodeAt(col, row + 1)
                    ];

                    for (let n = 0; n < neighbors.length; n++) {
                        let neighbor = neighbors[n];
                        if (!neighbor) continue;

                        let avgTemp = (node.temp + neighbor.temp) * 0.5;
                        let gradient = abs(node.temp - neighbor.temp);
                        let hueBlend = lerpColor(cold, warm, avgTemp);
                        let lineColor = lerpColor(hueBlend, glow, gradient * 1.5);

                        latticeLayer.stroke(lineColor);
                        latticeLayer.strokeWeight(0.6 + gradient * 2.2);
                        latticeLayer.line(node.x, node.y, neighbor.x, neighbor.y);
                    }
                }
            }
        }

        function spawnCarriers() {
            for (let i = 0; i < params.carrierCount; i++) {
                carriers.push(new ThermalCarrier());
            }
        }

        function draw() {
            trailLayer.noStroke();
            trailLayer.fill(250, 249, 245, 14);
            trailLayer.rect(0, 0, width, height);

            for (let i = 0; i < carriers.length; i++) {
                carriers[i].step();
                carriers[i].render(trailLayer);
            }

            clear();
            image(latticeLayer, 0, 0);
            image(trailLayer, 0, 0);
        }

        // ═══════════════════════════════════════════════════════════════════════
        // PARTICLE SYSTEM - CUSTOMIZE FOR YOUR ALGORITHM
        // ═══════════════════════════════════════════════════════════════════════

        class ThermalCarrier {
            constructor() {
                this.x = random(width);
                this.y = random(height);
                this.vx = 0;
                this.vy = 0;
            }

            step() {
                let tempHere = temperatureAt(this.x, this.y);
                let tx = temperatureAt(this.x + gradientStep, this.y);
                let ty = temperatureAt(this.x, this.y + gradientStep);

                let gradX = tx - tempHere;
                let gradY = ty - tempHere;

                let curl = noise(this.x * 0.006, this.y * 0.006) * TWO_PI * 2.0;
                let curlVec = createVector(cos(curl), sin(curl)).mult(0.4);

                let drift = createVector(gradX, gradY).mult(params.carrierSpeed * 8);
                drift.add(curlVec);

                this.vx = lerp(this.vx, drift.x, 0.35);
                this.vy = lerp(this.vy, drift.y, 0.35);

                this.x += this.vx;
                this.y += this.vy;

                if (this.x < 0) this.x = width;
                if (this.x > width) this.x = 0;
                if (this.y < 0) this.y = height;
                if (this.y > height) this.y = 0;
            }

            render(layer) {
                let temp = temperatureAt(this.x, this.y);
                let cold = color(params.colorPalette[0]);
                let warm = color(params.colorPalette[1]);
                let glow = color(params.colorPalette[2]);
                let c = lerpColor(cold, warm, temp);
                c = lerpColor(c, glow, temp * 0.6);

                layer.stroke(c);
                layer.strokeWeight(1.1);
                layer.point(this.x, this.y);
            }
        }

        // ═══════════════════════════════════════════════════════════════════════
        // UI CONTROL HANDLERS - CUSTOMIZE FOR YOUR PARAMETERS
        // ═══════════════════════════════════════════════════════════════════════

        function updateParam(paramName, value) {
            let numericValue = parseFloat(value);
            if (paramName === 'latticeSpacing' || paramName === 'sourceCount' || paramName === 'carrierCount') {
                numericValue = parseInt(value, 10);
            }

            params[paramName] = numericValue;
            document.getElementById(paramName + '-value').textContent = numericValue;
            initializeSystem();
        }

        function updateColor(colorId, value) {
            let index = 0;
            if (colorId === 'color2') index = 1;
            if (colorId === 'color3') index = 2;
            params.colorPalette[index] = value;
            document.getElementById(colorId + '-value').textContent = value;
            initializeSystem();
        }

        function regenerateSystem() {
            initializeSystem();
        }

        function downloadArtwork() {
            saveCanvas('thermal-lattices-' + params.seed, 'png');
        }

        // ═══════════════════════════════════════════════════════════════════════
        // SEED CONTROL FUNCTIONS - ALWAYS KEEP THESE
        // ═══════════════════════════════════════════════════════════════════════

        function updateSeedDisplay() {
            document.getElementById('seed-input').value = params.seed;
        }

        function updateSeed() {
            let input = document.getElementById('seed-input');
            let newSeed = parseInt(input.value);
            if (newSeed && newSeed > 0) {
                params.seed = newSeed;
                initializeSystem();
            } else {
                updateSeedDisplay();
            }
        }

        function previousSeed() {
            params.seed = Math.max(1, params.seed - 1);
            updateSeedDisplay();
            initializeSystem();
        }

        function nextSeed() {
            params.seed = params.seed + 1;
            updateSeedDisplay();
            initializeSystem();
        }

        function randomSeedAndUpdate() {
            params.seed = Math.floor(Math.random() * 999999) + 1;
            updateSeedDisplay();
            initializeSystem();
        }

        function resetParameters() {
            params = {...defaultParams};

            document.getElementById('latticeSpacing').value = params.latticeSpacing;
            document.getElementById('latticeSpacing-value').textContent = params.latticeSpacing;
            document.getElementById('noiseScale').value = params.noiseScale;
            document.getElementById('noiseScale-value').textContent = params.noiseScale;
            document.getElementById('warpStrength').value = params.warpStrength;
            document.getElementById('warpStrength-value').textContent = params.warpStrength;
            document.getElementById('sourceCount').value = params.sourceCount;
            document.getElementById('sourceCount-value').textContent = params.sourceCount;
            document.getElementById('sourceStrength').value = params.sourceStrength;
            document.getElementById('sourceStrength-value').textContent = params.sourceStrength;
            document.getElementById('carrierCount').value = params.carrierCount;
            document.getElementById('carrierCount-value').textContent = params.carrierCount;
            document.getElementById('carrierSpeed').value = params.carrierSpeed;
            document.getElementById('carrierSpeed-value').textContent = params.carrierSpeed;

            document.getElementById('color1').value = params.colorPalette[0];
            document.getElementById('color1-value').textContent = params.colorPalette[0];
            document.getElementById('color2').value = params.colorPalette[1];
            document.getElementById('color2-value').textContent = params.colorPalette[1];
            document.getElementById('color3').value = params.colorPalette[2];
            document.getElementById('color3-value').textContent = params.colorPalette[2];

            updateSeedDisplay();
            initializeSystem();
        }

        window.addEventListener('load', function() {
            updateSeedDisplay();
        });
    </script>
</body>
</html>
